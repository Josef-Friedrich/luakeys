%% luakeys-debug.sty
%% Copyright 2020 Josef Friedrich
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3 or later is part of all distributions of LaTeX
% version 2005/12/01 or later.
%
% This work has the LPPL maintenance status `maintained'.
%
% The Current Maintainer of this work is Josef Friedrich.
%
% This work consists of the files luakeys.lua, luakeys-debug.sty
% and luakeys-debug.tex.

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{luakeys-debug}[2020/01/17 Debug package for luakeys.]

%\input luakeys-debug.tex

\directlua{
  luakeys = require('luakeys')
}

\newcommand{\luakeysdebug}[2][]{
  {
    \tt
    \parindent=0pt
    \directlua{
      local options_raw = luakeys.parse('#1')
      local result = luakeys.parse('#2', options_raw)
      tex.print(luakeys.stringify(result, true))
      luakeys.print(result)
    }
  }
}
